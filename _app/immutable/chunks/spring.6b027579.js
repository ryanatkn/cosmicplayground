import{w as D}from"./index.adfb9031.js";import{n as A,l as E}from"./index.b9cc0b28.js";import{i as P}from"./utils.23a110f2.js";function k(s,m,t,r){if(typeof t=="number"||P(t)){const n=r-t,e=(t-m)/(s.dt||1/60),f=s.opts.stiffness*n,o=s.opts.damping*e,d=(f-o)*s.inv_mass,i=(e+d)*s.dt;return Math.abs(i)<s.opts.precision&&Math.abs(n)<s.opts.precision?r:(s.settled=!1,P(t)?new Date(t.getTime()+i):t+i)}else{if(Array.isArray(t))return t.map((n,e)=>k(s,m[e],t[e],r[e]));if(typeof t=="object"){const n={};for(const e in t)n[e]=k(s,m[e],t[e],r[e]);return n}else throw new Error(`Cannot spring ${typeof t} values`)}}function z(s,m={}){const t=D(s),{stiffness:r=.15,damping:n=.8,precision:e=.01}=m;let f,o,d,i=s,l=s,c=1,w=0,b=!1;function M(y,p={}){l=y;const j=d={};return s==null||p.hard||g.stiffness>=1&&g.damping>=1?(b=!0,f=A(),i=y,t.set(s=l),Promise.resolve()):(p.soft&&(w=1/((p.soft===!0?.5:+p.soft)*60),c=0),o||(f=A(),b=!1,o=E(a=>{if(b)return b=!1,o=null,!1;c=Math.min(c+w,1);const h={inv_mass:c,opts:g,settled:!0,dt:(a-f)*60/1e3},C=k(h,i,s,l);return f=a,i=s,t.set(s=C),h.settled&&(o=null),!h.settled})),new Promise(a=>{o.promise.then(()=>{j===d&&a()})}))}const g={set:M,update:(y,p)=>M(y(l,s),p),subscribe:t.subscribe,stiffness:r,damping:n,precision:e};return g}export{z as s};
